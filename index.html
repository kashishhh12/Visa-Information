<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visa Information</title>
    <style>
        /* Reset styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        /* Body styles */
        body {
            font-family: Arial, sans-serif;
            background-image: url('back.jpeg');
            background-size: contain;
            background-position: center;
            min-height: 80vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        /* Overlay styles */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.5);
        }
        /* Content wrapper styles */
        .content-wrapper {
            max-width: 800px;
            padding: 20px;
            text-align: center;
            position: relative;
            z-index: 1;
        }
        /* Header styles */
        header {
            margin-bottom: 20px;
            position: relative;
        }
        /* Logo styles */
        #logo {
            position: fixed;
            top: 10px;
            left: 10px;
            width: 100px;
            height: auto;
        }
        /* Navigation styles */
        nav {
            margin-bottom: 20px;
        }
        nav a {
            margin-right: 10px;
            text-decoration: none;
            color: #333;
        }
        /* Form styles */
        form {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
        }
        input[type="text"] {
            width: calc(100% - 22px);
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
        }
        button {
            padding: 10px 20px;
            background-color: #007BFF;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #0056B3;
        }
        /* Footer styles */
        footer {
            margin-top: auto;
        }
        /* Country section styles */
        .countries {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }
        .country {
            width: calc(33.33% - 20px);
            margin: 10px;
            padding: 20px;
            background-color: #F9F9F9;
            border-radius: 10px;
            text-align: center;
            max-width: 250px;
        }
        .country img {
            width: 200px;
            height: auto;
            display: block;
            margin: 0 auto 10px;
        }
        .country h3 {
            font-size: 24px;
            margin-bottom: 10px;
        }
        .country p {
            font-size: 16px;
        }
        a {
            text-decoration: inherit;
            color: inherit;
        }
        /* Responsive Styles */
        @media (max-width: 600px) {
            #logo {
                position: relative;
                top: 0;
                left: 0;
                margin: 0 auto;
            }
            nav {
                display: flex;
                flex-direction: column;
                align-items: center;
            }
            nav a {
                margin-bottom: 10px;
            }
            .countries {
                flex-direction: column;
                align-items: center;
            }
            .country {
                width: 100%;
                max-width: none;
                margin: 10px 0;
            }
        }

        @media (min-width: 601px) and (max-width: 768px) {
            .countries {
                flex-direction: column;
                align-items: center;
            }
            .country {
                width: 100%;
                max-width: none;
                margin: 10px 0;
            }
        }

        @media (min-width: 769px) and (max-width: 1024px) {
            .countries {
                justify-content: space-around;
            }
            .country {
                width: calc(50% - 20px);
                margin: 10px;
            }
        }

        @media (min-width: 1025px) {
            .countries {
                justify-content: space-between;
            }
            .country {
                width: calc(33.33% - 20px);
                margin: 10px;
            }
        }
        
    </style>
</head>
<body>
    <header>
        <img src="airplane.jfif" alt="Header Image" id="logo">
        <h1>Musafir</h1>
    </header>
    <div class="content-wrapper">
        <nav>
            <a href="#visa_info">Visa Information</a>
            <a href="https://www.musafir.com/about/default.aspx">About Us</a>
            <a href="https://www.musafir.com/about/contact-us---covid-19-special-helpdesk.aspx">Contact</a>
        </nav>
        <section id="visa_info">
            <h2>Visa Information</h2>
            <p>Check if your nationality requires a visa for your desired destination:</p>
            <form id="visa-form">
                <label for="source_country">Source Country:</label>
                <input type="text" id="source_country" name="source_country">
                <label for="nationality">Select your nationality:</label>
                <select id="nationality" name="nationality" style="width: calc(100% - 22px); padding: 10px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 5px; font-size: 16px;">
                    <option value="Indian">Indian</option>
                </select><br>
                <label for="destination">Select your destination:</label>
                <select id="destination" name="destination" style="width: calc(100% - 22px); padding: 10px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 5px; font-size: 16px;">
                    <!-- Options will be populated dynamically -->
                </select><br>
                <button type="submit">Check Visa Requirement</button>
            </form>
            <div id="result"></div>
        </section>
        <section class="countries">
            <div class="country">
                <a href="https://www.musafir.com/visa/france-visa.aspx">
                    <img src="france.jpg" alt="France">
                    <h3>France</h3>
                    <p>France is renowned for its art, cuisine, and fashion. The Eiffel Tower, located in Paris, is one of the most iconic landmarks in the world.</p>
                </a>
            </div>
            <div class="country">
                <a href="https://www.musafir.com/visa/russian-visa.aspx">
                    <img src="russia.jpg" alt="Russia">
                    <h3>Russia</h3>
                    <p>Russia is the largest country in the world, covering more than one-eighth of the Earth's inhabited land area. Moscow, its capital, is known for its architectural landmarks such as the Kremlin and Red Square.</p>
                </a>
            </div>
            <div class="country">
                <a href="https://www.musafir.com/visa/usvisa.aspx">
                    <img src="usa.jpg" alt="USA">
                    <h3>United States</h3>
                    <p>The United States of America (USA) is a diverse country with a rich cultural heritage and stunning natural landscapes. It is home to iconic landmarks such as the Statue of Liberty, Grand Canyon, and Hollywood.</p>
                </a>
            </div>
        </section>
        <section class="countries">
            <div class="country">
                <a href="https://in.musafir.com/Visa/italy-visa.aspx">
                    <img src="italy.jpg" alt="Italy">
                    <h3>Italy</h3>
                    <p>Italy is renowned for its art, history, and cuisine. The Colosseum, located in Rome, is an ancient amphitheater and one of the most iconic symbols of Rome and Italy.</p>
                </a>
            </div>
            <div class="country">
                <a href="https://www.musafir.com/Visa/spain-visa">
                    <img src="spain.jpg" alt="Spain">
                    <h3>Spain</h3>
                    <p>Spain is known for its rich cultural heritage, stunning architecture, and vibrant festivals. The Sagrada Familia in Barcelona and the Alhambra in Granada are among its famous landmarks.</p>
                </a>
            </div>
            <div class="country">
                <a href="https://www.musafir.com/visa/unitedkingdomvisa.aspx">
                    <img src="uk.jpg" alt="UK">
                    <h3>United Kingdom</h3>
                    <p>The United Kingdom (UK) consists of four countries: England, Scotland, Wales, and Northern Ireland. It is known for its historic landmarks, royal palaces, and picturesque countryside.</p>
                </a>
            </div>
            <a href="https://www.musafir.com/Visa"  style="position: absolute; bottom: 30px; right: 20px;">See More</a>
        </section>
        <footer>
            <p>&copy; 2024 All rights reserved.</p>
        </footer>
    </div>
    <script>
        // Function to dynamically populate the destination dropdown based on source country
        function populateDestinations() {
            fetch('http://127.0.0.1:5000/visainformation')
                .then(response => response.json())
                .then(data => {
                    const destinationSelect = document.getElementById('destination');
                    destinationSelect.innerHTML = ''; // Clear existing options
                    data.forEach(country => {
                        const option = document.createElement('option');
                        option.value = country.destination_country;
                        option.textContent = country.destination_country;
                        destinationSelect.appendChild(option);
                    });
                })
                .catch(error => {
                    console.error('Error fetching destination countries:', error);
                });
        }

        // Function to dynamically populate the nationality dropdown
        function populateNationalities() {
            fetch('http://127.0.0.1:5000/nationalities')
                .then(response => response.json())
                .then(data => {
                    const nationalitySelect = document.getElementById('nationality');
                    nationalitySelect.innerHTML = ''; // Clear existing options
                    data.forEach(nationality => {
                        const option = document.createElement('option');
                        option.value = nationality.nationality;
                        option.textContent = nationality.nationality;
                        nationalitySelect.appendChild(option);
                    });
                })
                .catch(error => {
                    console.error('Error fetching nationalities:', error);
                });
        }

        // Call the function to populate destinations and nationalities on page load
        window.onload = function() {
            populateDestinations();
            populateNationalities();
        };

        // Function to check visa requirements
        function checkVisaRequirement(event) {
            event.preventDefault(); // Prevent the form from submitting traditionally

            const sourceCountryInput = document.getElementById('source_country');
            const sourceCountry = sourceCountryInput.value.trim(); // Trim to remove extra spaces

            // Check if the input is empty
            if (sourceCountry === '') {
                alert('Please enter a source country.');
                return;
            }

            // Check if the input is valid (only letters and up to 3 characters)
            if (!/^[A-Za-z]+$/.test(sourceCountry)) {
                alert('Please enter only letters for the source country.');
                return;
            }

            if (sourceCountry.length > 3) {
                alert('Source country should not exceed 3 characters.');
                return;
            }

            const nationality = document.getElementById('nationality').value;
            const destination = document.getElementById('destination').value;

            // Validate if destination is selected
            if (!destination) {
                alert('Please select a destination.');
                return;
            }

            fetch(`http://127.0.0.1:5001/visainfo/${nationality}/${sourceCountry}/${destination}`)
                .then(response => response.json())
                .then(data => {
                    const newWindow = window.open('', '_blank');
                    newWindow.document.write('<html><head><title>Visa Information Result</title>');
                    newWindow.document.write('<style>');
                    newWindow.document.write(`
                        body {
                            font-family: Arial, sans-serif;
                            background-image: url('back.jpeg');
                            background-size: contain;
                            background-position: center;
                            min-height: 80vh;
                            display: flex;
                            flex-direction: column;
                            justify-content: center;
                            align-items: center;
                            position: relative;
                        }
                        body::before {
                            content: '';
                            position: absolute;
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 100%;
                            background-color: rgba(255, 255, 255, 0.5);
                        }
                        .content-wrapper {
                            max-width: 800px;
                            padding: 20px;
                            text-align: center;
                            position: relative;
                            z-index: 1;
                        }
                        table {
                            width: 100%;
                            border-collapse: collapse;
                            margin-top: 20px;
                        }
                        table, th, td {
                            border: 1px solid #ddd;
                        }
                        th, td {
                            padding: 10px;
                            text-align: left;
                        }
                        th {
                            background-color: #f2f2f2;
                        }
                        ul {
                            list-style-type: disc;
                            padding-left: 20px;
                        }
                        footer {
                            margin-top: auto;
                        }
                    `);
                    newWindow.document.write('</style></head><body>');
                    newWindow.document.write('<div class="content-wrapper">');
                    newWindow.document.write('<h1>Visa Information Result</h1>');

                    if (data.error) {
                        newWindow.document.write(`<b>Error:</b> ${data.error}`);
                    } else {
                        data.forEach(info => {
                            const documentRequirements = info.Document_requirement.split(',').map(item => `<li>${item.trim()}</li>`).join('');
                            newWindow.document.write(`
                                <table>
                                    <tr>
                                        <th>Nationality</th>
                                        <td>${info.nationality}</td>
                                    </tr>
                                    <tr>
                                        <th>Source Country</th>
                                        <td>${info.source_country}</td>
                                    </tr>
                                    <tr>
                                        <th>Destination Country</th>
                                        <td>${info.destination_country}</td>
                                    </tr>
                                    <tr>
                                        <th>Visa Requirement</th>
                                        <td>${info.visa_requirement}</td>
                                    </tr>
                                    <tr>
                                        <th>Visa Type</th>
                                        <td>${info.visa_type}</td>
                                    </tr>
                                    <tr>
                                        <th>Validity</th>
                                        <td>${info.validity}</td>
                                    </tr>
                                    <tr>
                                        <th>Max Stay</th>
                                        <td>${info.max_stay}</td>
                                    </tr>
                                    <tr>
                                        <th>Service Fee (in AED)</th>
                                        <td>${info["service_fee(in AED)"]}</td>
                                    </tr>
                                    <tr>
                                        <th>Document Required</th>
                                        <td><ul>${documentRequirements}</ul></td>
                                    </tr>
                                </table>
                                <hr>
                            `);
                        });
                    }

                    newWindow.document.write('</div><footer>&copy; 2024 All rights reserved.</footer>');
                    newWindow.document.write('</body></html>');
                    newWindow.document.close(); // Close the document to finish writing to it
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('An error occurred. Please try again.');
                });
        }

        // Attach event listener to the form
        document.getElementById('visa-form').addEventListener('submit', checkVisaRequirement);
        // Wait for document to load 
    $(document).ready(() => { 
        $('#visa_info').on('submit', () => { 
  
            // prevents default behaviour 
            // Prevents event propagation 
            return false; 
        }); 
    }); 
    $('#visa_info').keypress((e) => { 
  
        // Enter key corresponds to number 13 
        if (e.which === 13) { 
            $('#visa_info').submit();
        } 
    })
    </script>
</body>
</html>
